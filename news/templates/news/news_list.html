{% extends "base.html" %}

{% block content %}
<div class="max-w-5xl mx-auto py-8">
  <h1 class="text-2xl font-bold mb-6">Новости</h1>

  {% if user.is_authenticated and user.role in "admin hr manager" %}
    <a href="{% url 'news:create' %}" class="inline-block bg-white  px-4 py-2 rounded hover:bg-green-700 mb-3">
      ➕ Добавить новость
    </a>
  {% endif %}

  <div class="flex flex-col gap-6">
    {% for news in news_items %}
      <div class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
        <h2 class="text-2xl font-semibold text-blue-700 mb-2">
          <a href="{% url 'news:detail' news.pk %}" class="hover:underline">
            {{ news.title }}
          </a>
        </h2>
        <p class="text-gray-600 text-sm mb-2">
          {{ news.created_at|date:"d.m.Y H:i" }}
          {% if news.author %} — {{ news.author.username }}{% endif %}
        </p>
        <p class="text-gray-800 mb-4">{{ news.content|truncatewords:35 }}</p>

        {% if news.tags.all %}
        <div class="mb-4 flex flex-wrap gap-2">
          {% for tag in news.tags.all %}
            <span class="bg-blue-100 text-blue-700 text-xs font-semibold px-2 py-1 rounded">{{ tag.name }}</span>
          {% endfor %}
        </div>
        {% endif %}

        <div class="flex justify-between items-center">
          <a href="{% url 'news:detail' news.pk %}" class="text-blue-500 hover:underline font-medium">
            Читать далее
          </a>
          {% if user.is_authenticated and user.role in "admin hr manager" %}
            <a href="{% url 'news:edit' news.pk %}" class="text-blue-600 hover:underline text-sm">
              ✏️ Редактировать
            </a>
          {% endif %}
        </div>
      </div>
    {% empty %}
      <p class="text-gray-600">Нет опубликованных новостей.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
