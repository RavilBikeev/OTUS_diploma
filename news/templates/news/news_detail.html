{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="max-w-3xl mx-auto py-4">
  <h1 class="text-3xl font-bold">{{ news.title }}</h1>
  <p class="text-gray-600">{{ news.created_at|date:"d.m.Y H:i" }}</p>
    {% if user.is_authenticated and user.role in "admin hr manager" %}
        <a href="{% url 'news:edit' news.pk %}" class="text-blue-600 hover:underline">Редактировать</a>
    {% endif %}
  <div class="mt-4">{{ news.content|linebreaks }}</div>

  <hr class="my-6">

  <h2 class="text-xl font-semibold mb-2">Комментарии</h2>

  {% if user.is_authenticated %}
  <form method="post" class="mb-4">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Оставить комментарий</button>
  </form>
  {% else %}
  <p><a href="{% url 'login' %}" class="text-blue-600 underline">Войдите</a>, чтобы оставить комментарий.</p>
  {% endif %}

  {% for comment in comments %}
  <div class="border p-3 mb-3 rounded">
    <strong>{{ comment.author.username }}</strong> —
    <span class="text-sm text-gray-500">{{ comment.created_at|date:"d.m.Y H:i" }}</span>
    <p class="mt-2">{{ comment.content }}</p>
  </div>
  {% empty %}
  <p>Пока нет комментариев.</p>
  {% endfor %}
</div>
{% endblock %}
